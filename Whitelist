local url = "https://raw.githubusercontent.com/02052011Rafael/02052011Rafael/main/whitelist"
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

if not player then return end -- asegurarse de ejecutarse en cliente

-- Si HttpService está deshabilitado no se puede comprobar la whitelist
if not HttpService.HttpEnabled then
    return -- evita kicks falsos; habilita HTTP en settings y usa el script de nuevo
end

local success, result = pcall(function()
    return HttpService:GetAsync(url, true) -- true evita cache
end)

if not success or not result then
    player:Kick("No estás autorizado para usar este script.") -- fallo al leer la lista
    return
end

-- Normalizar y separar por cualquier espacio/coma/salto de línea
result = result:gsub("\r", " "):gsub("\n", " "):gsub(",", " ")
for user in string.gmatch(result, "[^%s]+") do
    if string.lower(user) == string.lower(player.Name) then
        return -- está en la whitelist -> termina el script y no hace kick
    end
end

player:Kick("No estás autorizado para usar este script.")
